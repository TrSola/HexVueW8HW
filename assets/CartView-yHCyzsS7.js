import{r as x,s as A,o as q,b as k,d as i,e as c,h as C,f as t,k as d,F as w,p as U,D as $,E as B,t as _,i as L,j as N,l as R}from"./index-js9NqjrV.js";import{a as f}from"./axios-L6U4YIEh.js";import{S as r}from"./sweetAlertStore-sgtDbShm.js";import{S}from"./sweetalert2.all-QbaEHGpC.js";import{u as j}from"./cartStore-tcvG4XLl.js";var H={VITE_APP_URL:"https://ec-course-api.hexschool.io/v2",VITE_APP_PATH:"aca101139",BASE_URL:"/HexVueW8HW/",MODE:"production",DEV:!1,PROD:!0,SSR:!1};const F={class:"container"},O={class:"mt-6"},z={class:"row"},I={key:0,class:"text-end"},Q=R('<h2 class="pt-7 mt-6 h1" style="font-size:58px;"><strong>試試放一項商品到購物車中吧</strong></h2><div class="pb-7"></div><div class="pb-7"></div><div class="pb-7"></div><div class="pb-5"></div>',5),W=[Q],G=t("h3",{class:"mt-3 mb-5"},"購物車",-1),J={class:"col-md-8"},K={class:"table"},X=t("thead",null,[t("tr",null,[t("th",{scope:"col",class:"border-0 ps-0"},"商品"),t("th",{scope:"col",class:"border-0 ps-3"},"商品數量"),t("th",{scope:"col",class:"border-0"},"價格")])],-1),Y={scope:"row",class:"border-0 px-0 font-weight-normal py-4"},Z=["src"],tt={class:"mb-0 fw-bold d-inline-block"},ot={class:"border-0 align-middle",style:{"max-width":"160px"}},et={class:"input-group"},st={class:"input-group-prepend"},nt=["onClick","disabled"],at=t("i",{class:"fas fa-minus"},null,-1),dt=[at],lt=["onUpdate:modelValue","onBlur","disabled"],it={class:"input-group-append"},ct=["onClick"],rt=t("i",{class:"fas fa-plus"},null,-1),ut=[rt],_t={class:"border-0 align-middle"},pt={class:"mb-0 ms-auto"},ht=["onClick","disabled"],bt=t("i",{class:"fas fa-times"},null,-1),mt=[bt],ft={class:"input-group w-50 mb-3"},vt=t("i",{class:"fas fa-paper-plane"},null,-1),gt=[vt],yt=t("p",{class:"text-muted"}," 2025/7/31前輸入優惠碼「迷你奧利給」全站商品享5折優惠 ",-1),xt={class:"col-md-4"},wt={class:"border p-4 mb-4"},kt=t("h4",{class:"fw-bold mb-4"},"訂單資料",-1),Ct={class:"table text-muted border-bottom"},$t=t("th",{scope:"row",class:"border-0 px-0 pt-4 font-weight-normal"}," 小計 ",-1),Bt={class:"text-end border-0 px-0 pt-4"},St=t("tr",null,[t("th",{scope:"row",class:"border-0 px-0 pt-0 pb-4 font-weight-normal"}," 付款方式 "),t("td",{class:"text-end border-0 px-0 pt-0 pb-4"},"ApplePay")],-1),Tt={key:0,class:"d-flex justify-content-between mt-4"},Vt=t("p",{class:"mb-0 h4 fw-bold"},"總計",-1),Pt={class:"mb-0 h4 fw-bold"},Et={key:1},Dt={class:"d-flex justify-content-between mt-4"},Mt=t("p",{class:"mb-0 h4 fw-bold text-del",style:{"text-decoration":"line-through"}}," 總計 ",-1),At={class:"mb-0 h4 fw-bold",style:{"text-decoration":"line-through"}},qt={class:"d-flex justify-content-between"},Ut=t("p",{class:"text-end text-muted mb-0 h4 fw-bold"},"折扣價",-1),Lt={class:"mb-0 h4 fw-bold"},zt={__name:"CartView",setup(Nt){const{VITE_APP_URL:p,VITE_APP_PATH:h}=H,a=x({loadingItem:""}),v=x(""),g=x(!1),T=j(),{carts:n}=A(T),y=o=>{a.value.loadingItem=o.id;const s=`${p}/api/${h}/cart/${o.id}`,l={product_id:o.product_id,qty:o.qty};f.put(s,{data:l}).then(()=>{r.showSuccessMsg("已更新購物車"),u(),a.value.loadingItem=""}).catch(b=>{alert(b.response.data.message),a.value.loadingItem=""})},V=()=>{S.fire({title:"是否清空購物車?",showDenyButton:!0,confirmButtonText:"確認清空",denyButtonText:"再想想好了",confirmButtonColor:"gray",denyButtonColor:"black"}).then(s=>{s.isConfirmed?(r.showSuccessMsg("刪除成功"),f.delete(o).then(()=>{u()}).catch(l=>{alert(l.response.data.message)})):s.isDenied&&r.showErrorMsg("已為您保留購物車")}).catch(()=>{alert("伺服器錯誤")});const o=`${p}/api/${h}/carts`},u=()=>{g.value=!0;const o=`${p}/api/${h}/cart`;f.get(o).then(s=>{n.value=s.data.data}).catch(s=>{alert(s.response.data.message)}).finally(()=>{g.value=!1})},P=o=>{S.fire({title:"確認要刪除",showDenyButton:!0,confirmButtonText:"確認刪除",denyButtonText:"再想想好了",confirmButtonColor:"gray",denyButtonColor:"black"}).then(l=>{l.isConfirmed?(a.value.loadingItem=o,r.showSuccessMsg("刪除成功"),f.delete(s).then(()=>{u(),a.value.loadingItem=""}).catch(b=>{alert(b.response.data.message)})):l.isDenied&&r.showErrorMsg("已為您保留該品項")});const s=`${p}/api/${h}/cart/${o}`},E=()=>{const o=`${p}/api/${h}/coupon`,s={code:v.value};f.post(o,{data:s}).then(()=>{r.showSuccessMsg("已加入優惠券"),u(),a.value.loadingItem=""}).catch(()=>{r.showErrorMsg("加入優惠券失敗"),u(),a.value.loadingItem=""})},D=o=>{o.qty++,y(o)},M=o=>{o.qty--,y(o)};return q(()=>{u()}),(o,s)=>{const l=k("VueLoading"),b=k("router-link");return i(),c(w,null,[C(l,{active:g.value,"z-index":1060},null,8,["active"]),t("div",F,[t("div",O,[t("div",z,[d(n).carts&&d(n).carts.length===0?(i(),c("div",I,W)):(i(),c(w,{key:1},[t("div",{class:"text-end"},[t("button",{class:"btn btn-outline-dark",type:"button",onClick:V}," 清空購物車 ")]),G,t("div",J,[t("table",K,[X,t("tbody",null,[(i(!0),c(w,null,U(d(n).carts,e=>(i(),c("tr",{class:"border-bottom border-top",key:e.id},[t("th",Y,[t("img",{src:e.product.imageUrl,alt:"商品圖片",style:{width:"52px",height:"52px","object-fit":"cover"}},null,8,Z),t("p",tt,_(e.product.title),1)]),t("td",ot,[t("div",et,[t("div",st,[t("button",{class:"btn btn-outline-dark border-0 py-2",type:"button",id:"button-addon1",onClick:m=>M(e),disabled:e.qty===1},dt,8,nt)]),$(t("input",{"onUpdate:modelValue":m=>e.qty=m,"type.prevent":"number",onBlur:m=>y(e),disabled:a.value.loadingItem===e.id,class:"form-control border-0 text-center my-auto shadow-none",placeholder:"","aria-label":"Example text with button addon","aria-describedby":"button-addon1",min:"1"},null,40,lt),[[B,e.qty,void 0,{number:!0}]]),t("div",it,[t("button",{class:"btn btn-outline-dark border-0 py-2",type:"button",id:"button-addon2",onClick:m=>D(e)},ut,8,ct)])])]),t("td",_t,[t("p",pt,_(e.product.price*e.qty),1)]),t("td",{class:"border-0 align-middle",onClick:m=>P(e.id),disabled:a.value.loadingItem===e.id,style:{cursor:"pointer"}},mt,8,ht)]))),128))])]),t("div",ft,[$(t("input",{type:"text",class:"form-control rounded-0 border-bottom border-top-0 border-start-0 border-end-0 shadow-none",placeholder:"請輸入優惠碼","aria-label":"Recipient's username","aria-describedby":"button-addon2","onUpdate:modelValue":s[0]||(s[0]=e=>v.value=e)},null,512),[[B,v.value]]),t("div",{class:"input-group-append"},[t("button",{onClick:E,class:"btn btn-outline-dark border-bottom border-top-0 border-start-0 border-end-0 rounded-0",type:"button",id:"button-addon2"},gt)])]),yt]),t("div",xt,[t("div",wt,[kt,t("table",Ct,[t("tbody",null,[t("tr",null,[$t,t("td",Bt,_(d(n).total),1)]),St])]),d(n).final_total===d(n).total?(i(),c("div",Tt,[Vt,t("p",Pt," NT$ "+_(d(n).total),1)])):(i(),c("div",Et,[t("div",Dt,[Mt,t("p",At," NT$ "+_(d(n).total),1)]),t("div",qt,[Ut,t("p",Lt," NT$ "+_(Math.floor(d(n).final_total)),1)])])),C(b,{to:"/checkOut",class:"btn btn-dark w-100 mt-4"},{default:L(()=>[N(" 去結帳")]),_:1})])])],64))])])])],64)}}};export{zt as default};
