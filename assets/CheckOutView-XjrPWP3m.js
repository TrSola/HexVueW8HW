import{B as S,i as p,o as A,r as d,a as r,b as c,e as o,d as e,F as y,m as R,t as i,w as k,n as v,C as $,D as C,f as L}from"./index-ePUxptxh.js";import{a as P}from"./axios-L6U4YIEh.js";import{S as j}from"./sweetAlertStore-wj0TG1rW.js";import"./sweetalert2.all-4tAPLIpz.js";var D={VITE_APP_URL:"https://ec-course-api.hexschool.io/v2",VITE_APP_PATH:"aca101139",BASE_URL:"/HexVueW8HW/",MODE:"production",DEV:!1,PROD:!0,SSR:!1};const M={class:"container mt-3"},N=e("div",{class:"row justify-content-center"},[e("div",{class:"col-md-10"},[e("h3",{class:"fw-bold mb-4 pt-3"},"結帳頁面")])],-1),q={class:"row flex-row-reverse justify-content-center pb-5"},B={key:0,class:"col-md-4"},H={class:"border p-4 mb-4"},O=["src","alt"],F={class:"w-100 mb-2"},z={class:"d-flex justify-content-between"},W={class:"mb-0 fw-bold"},G={class:"mb-0"},J={class:"mb-0 fw-bold"},K={class:"table mt-4 border-top border-bottom text-muted"},Q=e("th",{scope:"row",class:"border-0 px-0 pt-4 font-weight-normal"}," 小計 ",-1),X={class:"text-end border-0 px-0 pt-4"},Y=e("tr",null,[e("th",{scope:"row",class:"border-0 px-0 pt-0 pb-4 font-weight-normal"}," 付款方式 "),e("td",{class:"text-end border-0 px-0 pt-0 pb-4"},"ApplePay")],-1),Z={class:"d-flex justify-content-between mt-4"},I=e("p",{class:"mb-0 h4 fw-bold"},"總計",-1),ee={class:"mb-0 h4 fw-bold"},se={key:1,class:"col-md-4"},te=e("h2",null,"再去選購一些商品吧！",-1),le=[te],oe={class:"col-md-6"},ae={class:"mb-3"},ne=e("label",{for:"email",class:"form-label"},"電子郵件",-1),de={class:"mb-3"},re=e("label",{for:"name",class:"form-label"},"收件人姓名",-1),ce={class:"mb-3"},ie=e("label",{for:"tel",class:"form-label"},"收件人電話",-1),me={class:"mb-3"},ue=e("label",{for:"address",class:"form-label"},"收件人地址",-1),_e={class:"mb-3"},fe=e("label",{for:"message",class:"form-label"},"留言",-1),pe={class:"d-flex flex-column-reverse flex-md-row mt-4 justify-content-between align-items-md-center align-items-end w-100"},ve=e("i",{class:"fas fa-chevron-left me-2"},null,-1),Ve={__name:"CheckOutView",setup(he){const T=S(),n=p({}),{VITE_APP_URL:b,VITE_APP_PATH:x}=D,w=p(null),t=p({user:{name:"",email:"",tel:"",address:""},message:""}),h=p(!1),g=()=>{if(n.value.carts.length===0)alert("購物車內沒有品項");else{const m=`${b}/api/${x}/order`,s=t.value;P.post(m,{data:s}).then(u=>{j.showSuccessMsg("結帳成功!"),w.value.resetForm(),V(),T.push("/checkOutSuccess")}).catch(u=>{alert(u.response.data.message)})}},V=()=>{h.value=!0;const m=`${b}/api/${x}/cart`;P.get(m).then(s=>{n.value=s.data.data}).catch(s=>{alert(s.response.data.message)}).finally(()=>{h.value=!1})};return A(()=>{window.scrollTo(0,0),V()}),(m,s)=>{const u=d("VueLoading"),_=d("v-field"),f=d("error-message"),U=d("v-form"),E=d("router-link");return r(),c(y,null,[o(u,{active:h.value,"z-index":1060},null,8,["active"]),e("div",M,[N,e("div",q,[n.value.carts&&n.value.carts.length!==0?(r(),c("div",B,[e("div",H,[(r(!0),c(y,null,R(n.value.carts,l=>(r(),c("div",{class:"d-flex mt-2",key:l.id},[e("img",{src:l.product.imageUrl,alt:`${l.product.title}的圖片`,class:"me-2",style:{width:"48px",height:"48px","object-fit":"cover"}},null,8,O),e("div",F,[e("div",z,[e("p",W,i(l.product.title),1),e("p",G,"NT$"+i(l.product.price),1)]),e("p",J,"x"+i(l.qty),1)])]))),128)),e("table",K,[e("tbody",null,[e("tr",null,[Q,e("td",X," NT$"+i(Math.floor(n.value.final_total)),1)]),Y])]),e("div",Z,[I,e("p",ee,"NT$"+i(Math.floor(n.value.final_total)),1)])])])):(r(),c("div",se,le)),e("div",oe,[o(U,{ref_key:"formRef",ref:w,onSubmit:g},{default:k(({errors:l})=>[e("div",ae,[ne,o(_,{id:"email",name:"email",type:"email",class:v(["form-control",{"is-invalid":l.email}]),placeholder:"請輸入 Email",rules:"email|required",modelValue:t.value.user.email,"onUpdate:modelValue":s[0]||(s[0]=a=>t.value.user.email=a)},null,8,["class","modelValue"]),o(f,{name:"email",class:"invalid-feedback"})]),e("div",de,[re,o(_,{id:"name",name:"姓名",type:"text",class:v(["form-control",{"is-invalid":l.姓名}]),placeholder:"請輸入姓名",rules:"required",modelValue:t.value.user.name,"onUpdate:modelValue":s[1]||(s[1]=a=>t.value.user.name=a)},null,8,["class","modelValue"]),o(f,{name:"姓名",class:"invalid-feedback"})]),e("div",ce,[ie,o(_,{id:"tel",name:"電話",type:"text",class:v(["form-control",{"is-invalid":l.電話}]),placeholder:"請輸入電話",rules:"required|min:8|max:10",modelValue:t.value.user.tel,"onUpdate:modelValue":s[2]||(s[2]=a=>t.value.user.tel=a)},null,8,["class","modelValue"]),o(f,{name:"電話",class:"invalid-feedback"})]),e("div",me,[ue,o(_,{id:"address",name:"地址",type:"text",class:v(["form-control",{"is-invalid":l.地址}]),placeholder:"請輸入地址",rules:"required",modelValue:t.value.user.address,"onUpdate:modelValue":s[3]||(s[3]=a=>t.value.user.address=a)},null,8,["class","modelValue"]),o(f,{name:"地址",class:"invalid-feedback"})]),e("div",_e,[fe,$(e("textarea",{name:"",id:"message",class:"form-control",cols:"30",rows:"10","onUpdate:modelValue":s[4]||(s[4]=a=>t.value.message=a)},null,512),[[C,t.value.message]])])]),_:1},512),e("div",pe,[o(E,{to:"/cart",class:"text-dark mt-md-0 mt-3"},{default:k(()=>[ve,L("回到購物車")]),_:1}),e("button",{type:"button",class:"btn btn-danger",onClick:g}," 送出訂單 ")])])])])],64)}}};export{Ve as default};
